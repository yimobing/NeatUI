<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="网站名称">
    <meta name="applicable-device" content="pc,mobile">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>房贷计算器</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link type="text/css" rel="stylesheet" href="assets/neatui/css/neatui.min.css"><!--前端框架-->
    <link type="text/css" rel="stylesheet" href="assets/neatui/css/neatui-dialog.css"><!--对话框-->
    <link type="text/css" rel="stylesheet" href="assets/neatui/css/neatui-form.css"><!--表单布局-->
    <link type="text/css" rel="stylesheet" href="assets/neatui/css/neatui-inputsearch.css"><!--输入下拉-->
    <link type="images/x-icon" rel="shortcut icon" href="/favicon.ico">
    <!--<script type="text/javascript">if(top.location != self.location){ top.location = self.location; }</script>-->
</head>
<body>
    <style>
        body{ max-width: 640px; margin: 0 auto; padding: 3px; background-color: #f4f4f4; }
        /*计算表单*/
        .caculate {  }
        .caculate__form{ padding: 8px; background-color: #fff; border-radius: 4px; }
        .caculate__operate{ margin-top: 10px; }
        .caculate__operate button{ width: 100%; }
        /*计算结果*/
        .payback{ margin-top: 25px;  }
        .payback>div{ margin-bottom: 35px; padding: 15px 12px; background-color: #fff; }
        .payback>div:first-child{  }
        .payback__caption{ position: relative; font-weight: bold; font-size: 18px; }
        .payback__caption button{ position: absolute; right: 5px; top: 5px; background: none; border: 0; color: #08BA61; text-decoration: underline; cursor: pointer; }
        .payback__details{ margin-top: 15px; border: 1px solid #ddd!important; border-radius: 2px;  }
        .payback .eform-row{ margin-top: 0; }
        .payback .eform-row:last-child{ border-bottom: 0!important; }
        .payback .item-l{ width: 90px; }
        .payback .item-r{ border-left: 1px solid #ddd!important; }
        .payback .item-r input{ padding-right: 45px; text-align: right; }
        .payback .item-r.block .r-unit{ top: 25%; }
        .payback .cut{ margin: 5px 0 5px 0; margin-right: 8px; text-align: right; color: rgb(189, 187, 187); font-size: 12px; }
    </style>
    <div class="wrap">
        <main>
            <section class="caculate">
                <div class="caculate__form ne-form">
                    <div class="eform-row">
                        <div class="item-l"><label>房产总价</label></div>
                        <div class="item-r">
                            <input type="text" id="c-housePrice" data-type="float[positive]" readonly disabled>
                            <em class="r-unit">万元</em>
                        </div>
                    </div><!--/.eform-row-->
                    <div class="eform-row">
                        <div class="item-l"><label>按揭成数</label></div>
                        <div class="item-r"><input type="text" id="c-loanMix" value="70%" data-value="0.7" placeholder="比如：10%表示1成" onblur="this.placeholder='比如：10%表示1成'" onfocus="this.placeholder=''" readonly></div>
                        <div class="item-cell" data-type="must">*</div>
                    </div><!--/.eform-row-->
                    <div class="eform-row">
                        <div class="item-l"><label>贷款总额</label></div>
                        <div class="item-r">
                            <input type="text" id="c-loanAmount" data-type="float[positive]" placeholder="手输或房产总价、按揭成数计算" onblur="this.placeholder='手输或房产总价、按揭成数'" onfocus="this.placeholder=''">
                            <em class="r-unit">万元</em>
                        </div>
                        <div class="item-cell" data-type="must">*</div>
                    </div><!--/.eform-row-->
                    <div class="eform-row">
                        <div class="item-l"><label>贷款品种</label></div>
                        <div class="item-r"><input type="text" id="c-loanCategory" value="商业贷" placeholder="比如：商业贷"  onblur="this.placeholder='比如：商业贷'" onfocus="this.placeholder=''" readonly></div>
                        <div class="item-cell" data-type="must">*</div>
                    </div><!--/.eform-row-->
                    <div class="eform-row">
                        <div class="item-l"><label>贷款年限</label></div>
                        <div class="item-r">
                            <input type="text" id="c-loanYears" value="20年(240期)" data-value="240" placeholder="比如：15年" onblur="this.placeholder='比如：15年'" onfocus="this.placeholder=''" readonly>
                        </div>
                        <div class="item-cell" data-type="must">*</div>
                    </div><!--/.eform-row-->
                    <div class="eform-row">
                        <div class="item-l"><label>贷款利率</label></div>
                        <div class="item-r">
                            <input type="text" id="c-loanRate" value="4.90" data-type="float[positive]" placeholder="比如：基准利率4.9%" onblur="this.placeholder='比如：基准利率4.9%'" onfocus="this.placeholder=''">
                            <em class="r-unit">%</em>
                        </div>
                        <div class="item-cell" data-type="must">*</div>
                    </div><!--/.eform-row-->
                    <div class="eform-row">
                        <div class="item-l"><label>还款方式</label></div>
                        <div class="item-r"><input type="text" id="c-loanPayBackMethod" value="等额本息" placeholder="比如：等额本息、等额本金" onblur="this.placeholder='比如：等额本息、等额本金'" onfocus="this.placeholder=''" readonly></div>
                        <div class="item-cell" data-type="must">*</div>
                    </div><!--/.eform-row-->
                </div><!--/.caculate__form-->
                <div class="caculate__operate">
                    <button type="button" id="btn-confirm" class="ne-btn has-texture orange">开始计算并保存</button>
                </div>
            </section>
            <section class="payback">
                <!--[========等额本息========]-->
                <div class="payback__interest" style="display: none;">
                    <div class="payback__caption">等额本息<button type="button" id="btn-view-stage-amount-interest">查看分期金额</button></div>
                    <div class="payback__details ne-form theme-popular">
                        <div class="eform-row">
                            <div class="item-l"><label>贷款总额</label></div>
                            <div class="item-r"><input type="text" id="in-loanAmount" readonly><em class="r-unit">万元</em>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>还款月数</label></div>
                            <div class="item-r"><input type="text" id="in-monthTotal" readonly><em class="r-unit">月</em>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>每月还款</label></div>
                            <div class="item-r"><input type="text" id="in-payEveryMonth" readonly><em class="r-unit">元</em>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>总支付利息</label></div>
                            <div class="item-r"><input type="text" id="in-interestTotal" readonly><em class="r-unit">万元</em>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>本息合计</label></div>
                            <div class="item-r"><input type="text" id="in-principalInterestTotal" readonly><em class="r-unit">万元</em>
                            </div>
                        </div><!--/.eform-row-->
                    </div><!--/.payback__details-->
                </div><!--/.payback__interest-->
                <!--[========等额本金========]-->
                <div class="payback__principal" style="display: none;">
                    <div class="payback__caption">等额本金<button type="button" id="btn-view-stage-amount-principal">查看分期金额</button></div>
                    <div class="payback__details ne-form theme-popular">
                        <div class="eform-row">
                            <div class="item-l"><label>贷款总额</label></div>
                            <div class="item-r"><input type="text" id="pr-loanAmount" readonly><em class="r-unit">万元</em>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>还款月数</label></div>
                            <div class="item-r"><input type="text" id="pr-monthTotal" readonly><em class="r-unit">月</em>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>首月还款</label></div>
                            <div class="item-r block">
                                <input type="text" id="pr-payFirstMonth" readonly>
                                <em class="r-unit">元</em>
                                <div class="cut"><span class="cut__title">每月递减：</span><span class="cut__num" id="cutPerMonth"></span><em>元</em></div>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>总支付利息</label></div>
                            <div class="item-r"><input type="text" id="pr-interestTotal" readonly><em class="r-unit">万元</em>
                            </div>
                        </div><!--/.eform-row-->
                        <div class="eform-row">
                            <div class="item-l"><label>本息合计</label></div>
                            <div class="item-r"><input type="text" id="pr-principalInterestTotal" readonly><em class="r-unit">万元</em>
                            </div>
                        </div><!--/.eform-row-->
                    </div><!--/.payback__details-->
                </div><!--/.payback__principal-->
            </section>
        </main>
    </div><!--/.wrap-->


    <!--================================================================================-->
    <!--                            JAVASCRIPT                                          -->
    <!--================================================================================-->
    <script type="text/javascript" src="assets/style/libs/jquery-1.8.3.min.js"></script><!--jQuery库-->
    <script type="text/javascript" src="assets/neatui/js/neatui.min.js"></script><!--前端框架-->
    <script type="text/javascript" src="assets/neatui/js/neatui-dialog.js"></script><!--对话框-->
    <script type="text/javascript" src="assets/neatui/js/neatui-inputsearch.js"></script><!--输入下拉-->
    <script type="text/javascript" src="assets/neatui/js/neatui-functions.js"></script><!--函数库-->
    <script type="text/javascript" src="assets/neatui/js/neatui-ajax.js"></script><!--AJAX自定义封装-->
    <script type="text/javascript">
        /**
        计算结果是否正确，可参考：https://www.fangdaijisuanqi.net/
        */

        /*+————————————————全局变量————————————————+*/
        // ajax({})
        var g_ygdh = '2107130768-237809'; // 预估单号
        var g_pgjz = 1125000; // 评估总价
        // var g_ygdh = '<%=s_ygdh%>'; // 预估单号
        // var g_pgjz = '<%=s_pgzj%>'; // 评估总价

        //
        var digit = 2; // 统一设置保留的小数位数
        var counter = 0; // 计数器


        /*+————————————————FUNCTION————————————————+*/
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        $(function(){
            //————————————————————————————————————————————————————————————————————————————————————————————————————————————————
            //+                                                          初始化                                                 
            //————————————————————————————————————————————————————————————————————————————————————————————————————————————————
            //——————————————————————————————————————————
            //=====获取按揭数据
            // 后台返回
            var loanJson = {
                "return":"ok", 
                "anjie_chengshu":"0.8", 
                "daikuan_je":"900000", 
                "dkpz":"商业贷", 
                "huankuan_fangshi":"等额本息",
                "daikuan_nianxian":"30",
                "lilv":"5.2",
                "yuegong_je":"4942"
            }

            /*
            //START AJAX
            var loanJson = {}
            var isHoldOn = true;
            ajax({
                heading: "获取按揭数据",
                debug: false,
                async: false, // 取数方式. true 异步, false 同步(默认)
                type: "GET",
                dataType: "html",
                cache: false,
                url: "../../fwh_pub/jk_jiaoyi.ashx",
                data: {
                    "action": "sel_jiaoyi_ygd_a_anjie_chengshu",
                    "user": "<%=s_user%>",
                    "sjk": "<%=s_sjk%>",
                    "ygdh": g_ygdh
                },
                success: function(res){
                    if(toolTip.mistakeTips(res, this.url, this.heading, this.debug)) { isHoldOn = false; return; }
                    // if(res == '') return;
                    loanJson = JSON.parse(res);
                },
                error: function(res){
                    if(toolTip.wrongTips(res, this.url, this.heading, this.debug)) { isHoldOn = false; return; }
                },
                beforeSend: function(XMLHttpRequest){ },
                complete: function(XMLHttpRequest, textStatus){ }
            })
            if(!isHoldOn){
                neui.destroyAnimate();
                return;
            }
            //END AJAX
            */

            // 转化并赋值
            var years = parseInt(loanJson["daikuan_nianxian"]),
                months = years * 12,
                yearText = years + '年(' + months + '期)';
            $('#c-housePrice').val(format.thousandth(convert.yuan2TenThousand(g_pgjz)));
            $('#c-loanMix').val(convert.decimal2Percent(loanJson["anjie_chengshu"])).attr('data-value', loanJson["anjie_chengshu"]); // 按揭成数
            $('#c-loanAmount').val(format.thousandth(convert.yuan2TenThousand(loanJson["daikuan_je"]))); // 贷款总额
            $('#c-loanCategory').val(loanJson["dkpz"]); // 贷款品种
            $('#c-loanYears').val(yearText).attr('value', yearText).attr('data-value', months); // 贷款年限
            $('#c-loanRate').val(loanJson["lilv"]); // 贷款利率
            $('#c-loanPayBackMethod').val(loanJson["huankuan_fangshi"]); // 还款方式
            
            // 计算结果
            fnCalculateResult();
            




            //——————————————————————————————————————————
            //=====限制输入类型：只允许输入正整数
            $('[data-type="int[positive]"]').on('input', function(){
                var value = $(this).val();
                value = restrict.onlyInterval(value);
                $(this).val(value);
            });


            //——————————————————————————————————————————
            //=====限制输入类型：只允许输入正小数
            $('[data-type="float[positive]"]').on('input', function(){
                var value = $(this).val();
                value = restrict.onlyFloat(value);
                $(this).val(value);
            });
            // 失去焦点时：如果字符串最后面直接以一个小数点结尾, 则去掉这个小数点
            $('[data-type="float[positive]"]').on('blur', function(){
                var value = $(this).val();
                value = filter.lastDotChar(value);
                $(this).val(value);
            });




            //————————————————————————————————————————————————————————————————————————————————————————————————————————————————
            //+                                                            系列事件                                       
            //————————————————————————————————————————————————————————————————————————————————————————————————————————————————
            //——————————————————————————————————————————
            //=====房产总价输入事件
            $('#c-housePrice').on('input', function(){
                var total = parseFloat($(this).val().replace(/,/g, '')),
                    mix = typeof $('#c-loanMix').attr('data-value') == 'undefined' ? 0 : parseFloat($('#c-loanMix').attr('data-value'));
                fnCountLoanAmount(total, mix);
            });



            //——————————————————————————————————————————
            //=====按揭成数下拉
            $('#c-loanMix').on('click', function(){
                var $this = $(this);
                var mixJson = {"data":[
                    {"value":"10%"},
                    {"value":"20%"},
                    {"value":"30%"},
                    {"value":"40%"},
                    {"value":"50%"},
                    {"value":"60%"},
                    {"value":"70%"},
                    {"value":"80%"},
                    {"value":"90%"},
                    {"value":"100%"}
                ]}  
                neuiInputsearch({
                    source: mixJson,
                    event: "click",
                    onConfirm: function(e){
                        var $ele = $(e.dom),
                            value = e.value;
                        var newValue = value.toString().replace(/([%|成])/g, '');
                        var mix = value.indexOf('%') >= 0 ? parseFloat(newValue) / 100 : (value.indexOf('成') >= 0 ? parseFloat(newValue) / 10 : newValue);
                        $ele.attr('data-value', mix); // 小数. eg. 10% 或 1成 就是 0.1

                        var total = parseFloat($('#c-housePrice').val().replace(/,/g, ''));
                        fnCountLoanAmount(total, mix);
                    }
                }, $this)
            });


            /**
             * 子函数：计算贷款总额
             * @param {number} ps_price 房产总价(单位：元)
             * @param {number} ps_ratio 按揭成数(小数)
             */
            function fnCountLoanAmount(ps_price, ps_ratio){
                var total = isNaN(ps_price) ? 0 : parseFloat(ps_price),
                    mix = isNaN(ps_ratio) ? 0 : parseFloat(ps_ratio);
                // console.log('房产总价：', total, '\n按揭成数：', mix);
                var amount = (total) * parseFloat(mix);
                $('#c-loanAmount').val(amount); // 向上取整
            }


              


            //——————————————————————————————————————————
            //=====贷款品种下拉
            $('#c-loanCategory').on('click', function(){
                var $this = $(this);
                var categoryJson = {"data":[
                    {"value":"商业贷"},
                    {"value":"公积金贷(组合贷)"}
                ]}  
                neuiInputsearch({
                    source: categoryJson,
                    event: "click"
                }, $this)
            });






            //——————————————————————————————————————————
            //=====贷款年限下拉
            $('#c-loanYears').on('click', function(){
                var $this = $(this);
                var yearJson = {"data":[
                    {"value":"1年(12期)"},
                    {"value":"2年(24期)"},
                    {"value":"3年(36期)"},
                    {"value":"4年(48期)"},
                    {"value":"5年(60期)"},
                    {"value":"6年(72期)"},
                    {"value":"7年(84期)"},
                    {"value":"8年(96期)"},
                    {"value":"9年(108期)"},
                    {"value":"10年(120期)"},
                    {"value":"11年(132期)"},
                    {"value":"12年(144期)"},
                    {"value":"13年(156期)"},
                    {"value":"14年(168期)"},
                    {"value":"15年(180期)"},
                    {"value":"16年(192期)"},
                    {"value":"17年(204期)"},
                    {"value":"18年(216期)"},
                    {"value":"19年(228期)"},
                    {"value":"20年(240期)"},
                    {"value":"25年(300期)"},
                    {"value":"30年(360期)"},
                ]}  
                neuiInputsearch({
                    source: yearJson,
                    event: "click",
                    onConfirm: function(e){
                        var $ele = $(e.dom),
                            value = e.value;
                        var newValue = value.toString().replace(/([\d]*)年\(([\d]*)期\)/, '$2');
                        $ele.attr('data-value', newValue);
                    }
                }, $this)
            });






            //——————————————————————————————————————————
            //=====还款方式下拉
            $('#c-loanPayBackMethod').on('click', function(){
                var $this = $(this);
                var methodJson = {"data":[
                    {"value":"等额本息<em>(还款金额每月固定，即：偿还的本金逐月增加，但利息逐月递减)</em>"},
                    {"value":"等额本金<em>(还款金额逐月递减，即：偿还的本金每月固定，但利息逐月递减)</em>"}
                ]}  
                neuiInputsearch({
                    source: methodJson,
                    event: "click"
                }, $this)
            });


            //——————————————————————————————————————————
            //=====开始计算并保存按钮
            $('#btn-confirm').on('click', function(){
                fnCalculateResult();
            });

            //=====计算按揭结果
            function fnCalculateResult(){
                counter++;
                // 校验数据完整性
                var tips = '';
                $('.caculate__form .eform-row').each(function(){
                    var label = $('label', this).text(),
                        value = $('input:text', this).val(),
                        isMust = $('[data-type="must"]', this).length > 0 ? true : false;
                    if(isMust && value.toString().replace(/([ ]+)/g, '') === ''){
                        tips += label + '、';
                    }
                })
                if(tips != ''){
                    neuiDialog.notice({
                        message: '请填写：' + tips.substr(0, tips.length - 1),
                        theme: 'danger',
                        location: 'top'
                    })
                    return;
                }
                // 开始执行
                neui.showAnimate();
                setTimeout(function(){
                    var amount = parseFloat(convert.tenThousand2Yuan($('#c-loanAmount').val())), // 贷款总额(单位：元)
                        cate = $('#c-loanCategory').val(), // 贷款品种
                        month = parseInt($('#c-loanYears').attr('data-value')), // 贷款年限(单位：月)
                        rate = parseFloat($('#c-loanRate').val()) / 1200, // 贷款利率(月利率)
                        method = $('#c-loanPayBackMethod').val(); // 还款方式
                    var arr = [ amount, cate, month, rate, method ]
                    // console.log('数组：', arr);

                    // 变量
                    var monthlyPayment = 0; // 月供金额
                    // 等额本息
                    if(method.indexOf('等额本息') >= 0){
                        var payEveryMonth = ( amount * rate * Math.pow(1 + rate, month) ) / ( Math.pow(1 + rate, month) - 1 ); // 每月还款
                            interestTotal = payEveryMonth * month - amount; // 总支付利息,
                            principalInterestTotal = payEveryMonth * month; // 本息合计
                        // 转化
                        amount = format.thousandth(convert.yuan2TenThousand(amount));
                        month = format.thousandth(month);
                        payEveryMonth = format.thousandth(parseFloat(payEveryMonth).toFixed(digit));
                        principalInterestTotal = format.thousandth(convert.yuan2TenThousand(principalInterestTotal, 'round', digit));
                        interestTotal = format.thousandth(convert.yuan2TenThousand(interestTotal, 'round', digit));
                        // 赋值1
                        $('#in-loanAmount').val(amount); // 贷款总额(单位：万元)
                        $('#in-monthTotal').val(month); // 还款月数(单位：万元)
                        $('#in-payEveryMonth').val(payEveryMonth); // 每月还款(单位：元, 保留N位小数)
                        $('#in-principalInterestTotal').val(principalInterestTotal); // 本息合计(单位：万元, 保留N位小数)
                        $('#in-interestTotal').val(interestTotal); // 总支付利息(单位：万元，保留2位小数)
                         // 显示区域
                         $('.payback__interest').show().siblings().hide();
                         // 赋值2
                         monthlyPayment = payEveryMonth.toString().replace(/,/g, '');
                    }

                    // 等额本金
                    if(method.indexOf('等额本金') >= 0){
                        var payFirstMonth = amount * (1 + month * rate) / month, // 首月还款
                            cutPerMonth = amount * rate / month, // 每月递减(单位：元)
                            interestTotal2 =  amount * rate * (month + 1) / 2, // 总支付利息
                            principalInterestTotal2 = amount + amount * rate * (month + 1) / 2; // 本息合计
                        // 转化
                        amount = format.thousandth(convert.yuan2TenThousand(amount));
                        month = format.thousandth(month);
                        payFirstMonth = format.thousandth(parseFloat(payFirstMonth).toFixed(digit));
                        cutPerMonth = format.thousandth(parseFloat(cutPerMonth).toFixed(digit));
                        principalInterestTotal2 = format.thousandth(convert.yuan2TenThousand(principalInterestTotal2, 'round', digit));
                        interestTotal2 = format.thousandth(convert.yuan2TenThousand(interestTotal2, 'round', digit));
                        // 赋值
                        $('#pr-loanAmount').val(amount); // 贷款总额(单位：万元)
                        $('#pr-monthTotal').val(month); // 还款月数(单位：万元)
                        $('#pr-payFirstMonth').val(payFirstMonth); // 首月还款(单位：元, 保留N位小数)
                        $('#cutPerMonth').text(cutPerMonth); // 每月递减(单位：元, 保留N位小数)
                        $('#pr-principalInterestTotal').val(principalInterestTotal2); // 本息合计(单位：万元，保留N位小数)
                        $('#pr-interestTotal').val(interestTotal2); // 总支付利息(单位：万元，保留N位小数)
                        // 显示区域
                        $('.payback__principal').show().siblings().hide();
                         // 赋值2
                         monthlyPayment = payFirstMonth.toString().replace(/,/g, '');
                    }


                    // 传递给后台的参数
                    var ls_anjie_chengshu = $('#c-loanMix').attr('data-value'), // 按揭成数
                        ls_daikuan_je = convert.tenThousand2Yuan($('#c-loanAmount').val().toString().replace(/,/g, '')), // 贷款总额
                        ls_dkpz = cate, // 贷款品种
                        ls_huankuan_fangshi = method, // 还款方式
                        ls_daikuan_nianxian = $('#c-loanYears').val().toString().replace(/([\d]*)年\(([\d]*)期\)/, '$1'), // 贷款年限(单位：年)
                        ls_lilv = rate * 1200, // 利率
                        ls_yuegong_je = monthlyPayment; // 月供金额
                    // console.log('按揭成数：', ls_anjie_chengshu, '\n贷款总额：', ls_daikuan_je, '\n贷款品种：', ls_dkpz, '\n还款方式：', ls_huankuan_fangshi, '\n贷款年限：', ls_daikuan_nianxian, '\n利率：', ls_lilv, '\n月供：', ls_yuegong_je);
                    
                    // 开始执行
                    var flag = '', msg = '保存成功';
                    // 后台返回
                    /*
                    //START AJAX
                    var isHoldOn = true;
                    ajax({
                        heading: "保存按揭数据",
                        debug: false,
                        async: false, // 取数方式. true 异步, false 同步(默认)
                        type: "GET",
                        dataType: "html",
                        cache: false,
                        url: "../../fwh_pub/jk_jiaoyi.ashx",
                        data: {
                            "action": "save_jiaoyi_ygd_a_anjie_chengshu",
                            "user": "<%=s_user%>",
                            "sjk": "<%=s_sjk%>",
                            "ygdh": g_ygdh,
                            "anjie_chengshu": ls_anjie_chengshu,
                            "daikuan_je": ls_daikuan_je,
                            "dkpz": ls_dkpz,
                            "huankuan_fangshi": ls_huankuan_fangshi,
                            "daikuan_nianxian": ls_daikuan_nianxian,
                            "lilv": ls_lilv,
                            "yuegong_je": ls_yuegong_je
                        },
                        success: function(res){
                            if(toolTip.emptyTips(res, this.url, this.heading, this.debug)) { isHoldOn = false; return; }
                            var json = JSON.parse(res);
                            flag = json.return == 'ok' ? 1 : 0;
                            if(!flag) msg = json.data;
                        },
                        error: function(res){
                            if(toolTip.wrongTips(res, this.url, this.heading, this.debug)) { isHoldOn = false; return; }
                        },
                        beforeSend: function(XMLHttpRequest){ },
                        complete: function(XMLHttpRequest, textStatus){ }
                    })
                    if(!isHoldOn){
                        neui.destroyAnimate();
                        return;
                    }
                    //END AJAX
                    */
                    flag = parseInt(1); //1 成功, 0 失败
                    if(!flag) msg = '保存失败';


                    if(counter > 1){
                        neuiDialog.notice({
                            message: msg,
                            theme: 'black',
                            //location: 'top',
                            maskOpacity: 1,
                            delay: 1000
                        })
                    }
                    // neuiDialog.alert({
                    //     animate: true,
                    //     popup: flag ? false : true, // 成功不弹窗, 失败才弹窗
                    //     caption: '提示',
                    //     message: msg,
                    //     buttons: ['确定']
                    // })
                   
    
                    neui.destroyAnimate();
                }, 100)
            }





            //——————————————————————————————————————————
            //=====等额本息查看分期金额按钮
            $('#btn-view-stage-amount-interest').on('click', function(){ 
                var amount = parseFloat(convert.tenThousand2Yuan($('#c-loanAmount').val().replace(/,/g, ''))), // 贷款总额(单位：元)
                    month = parseInt($('#c-loanYears').attr('data-value')), // 贷款年限(单位：月)
                    rate = parseFloat($('#c-loanRate').val()), // 贷款利率(年利率)
                    method = $('#c-loanPayBackMethod').val(); // 还款方式
                var arr = [ amount, month, rate, method ]
                 // console.log('数组：', arr);
                neui.installmentPayment({
                    payment: "等额本息", // 还款方式(可选)。值：本额本息(默认), 等额本金
                    total: amount, // 贷款总额(可选), 单位：元。默认900000(即90万元)
                    month: month, // 贷款期数(可选), 单位：期(或月)。默认240。比如：15年就是15*12=180期, 20年就是20*12=240期, 30年就是30*12=360期
                    rate: rate, // 贷款年利率(可选), 单位：%。默认4.9%
                    digit: 2, // 保留小数位数(可选), 默认2
                    caption: "分期详情" // 窗口标题(可选), 默认空(系统会自动添加成"XX分期金额")
                })
            });





            //——————————————————————————————————————————
            //=====等额本金查看分期金额按钮
            $('#btn-view-stage-amount-principal').on('click', function(){ 
                var amount = parseFloat(convert.tenThousand2Yuan($('#c-loanAmount').val().replace(/,/g, ''))), // 贷款总额(单位：元)
                    month = parseInt($('#c-loanYears').attr('data-value')), // 贷款年限(单位：月)
                    rate = parseFloat($('#c-loanRate').val()), // 贷款利率(年利率)
                    method = $('#c-loanPayBackMethod').val(); // 还款方式
                var arr = [ amount, month, rate, method ]
                // console.log('数组：', arr);
                neui.installmentPayment({
                    payment: "等额本金", // 还款方式(可选)。值：本额本息(默认), 等额本金
                    total: amount, // 贷款总额(可选), 单位：元。默认900000(即90万元)
                    month: month, // 贷款期数(可选), 单位：期(或月)。默认240。比如：15年就是15*12=180期, 20年就是20*12=240期, 30年就是30*12=360期
                    rate: parseFloat($('#c-loanRate').val()), // 贷款年利率(可选), 单位：%。默认4.9%
                    digit: 2, // 保留小数位数(可选), 默认2
                    caption: "分期详情" // 窗口标题(可选), 默认空(系统会自动添加成"XX分期金额")
                })
            });

    
    
        }); //$(function(){});
    </script>


</body>
</html>