<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="网站名称">
    <meta name="applicable-device" content="pc,mobile">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>网页导出图片</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <link type="text/css" rel="stylesheet" href="assets/neatui/css/neatui.min.css"><!--前端框架-->
    <link type="images/x-icon" rel="shortcut icon" href="/favicon.ico">
    <script type="text/javascript">if(top.location != self.location){ top.location = self.location; }</script>
</head>
<body>

    <style>
        body{ max-width: 640px; margin: 0 auto; padding: 25px 10px; }
        .wrap{ padding: 10px 15px; }
        .head{
            position: fixed; top: 0; left: 0; right: 0; background-color: #fff; padding: 10px 15px; border: 1px solid #ddd;
        }
        .main{ padding-top: 30px; }

        .export{ margin-bottom: 25px; }
        button{ padding: 5px 10px; background-color: #f5f5f5; color: #fff; border: 0; border-radius: 4px;}
        button.blue{ background-color: #80c0ef; }
        button.green{ background-color: #08ba61; }
    </style>

    <div class="wrap">
        <header class="head">
            <button type="button" id="btn-save-web" class="blue">保存整个网页为图片</button>
        </header>
        <main class="main">
            <h1>将网页导出图片</h1>
            <h5>Bug说明：导出节点内如果使用到了本地图片作为背景图片，将会使画布受到污染从而无法导出，此时会报错“Uncaught DOMException: Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported”。解决办法是：把本地图片转换成base64图片即可！</h5>
            <section class="export">
                <button type="button" id="btn-save-area" class="green">保存黄色区域为图片</button>
            </section>

            <section class="content">
                <div class="user">
                    <div class="title">水浒传会物谱</div>
                    <div class="list">
                        <p><label>用户：</label><span>林冲</span></p>
                        <p><label>性别：</label><span>男</span></p>
                        <p><label>昵称：</label><span>豹子头</span></p>
                        <p><label>籍贯：</label><span>梁山泊</span></p>
                    </div>
                </div><!--/.user-->
                <div class="test" id="colored" style="padding: 10px; background: #f5da55">
                    <h4 style="color: #000; ">Hello world!</h4>
                </div><!--/.test-->
            </section>
            <article>
                极目新闻记者 姚岗据通报，10月20日，湖北省天门市新增2例外省输入本地新冠肺炎确诊病例（两人行动轨迹相同)，病例分型分别为轻型和普通型。两人为广东省广州市人。21日，其中一名确诊病例伍先生告诉极目新闻记者，10月9日至11日，他曾在内蒙古额济纳旗游玩，与此前被确诊的8人旅行团存在轨迹重叠。伍先生称，他从13日开始咳嗽，但自己以为是老毛病又犯了，压根没想到是被感染了，直到返程途中经过湖北主动去做核酸检测才被发现。 极目新闻记者 姚岗据通报，10月20日，湖北省天门市新增2例外省输入本地新冠肺炎确诊病例（两人行动轨迹相同)，病例分型分别为轻型和普通型。两人为广东省广州市人。21日，其中一名确诊病例伍先生告诉极目新闻记者，10月9日至11日，他曾在内蒙古额济纳旗游玩，与此前被确诊的8人旅行团存在轨迹重叠。伍先生称，他从13日开始咳嗽，但自己以为是老毛病又犯了，压根没想到是被感染了，直到返程途中经过湖北主动去做核酸检测才被发现。 极目新闻记者 姚岗据通报，10月20日，湖北省天门市新增2例外省输入本地新冠肺炎确诊病例（两人行动轨迹相同)，病例分型分别为轻型和普通型。两人为广东省广州市人。21日，其中一名确诊病例伍先生告诉极目新闻记者，10月9日至11日，他曾在内蒙古额济纳旗游玩，与此前被确诊的8人旅行团存在轨迹重叠。伍先生称，他从13日开始咳嗽，但自己以为是老毛病又犯了，压根没想到是被感染了，直到返程途中经过湖北主动去做核酸检测才被发现。 极目新闻记者 姚岗据通报，10月20日，湖北省天门市新增2例外省输入本地新冠肺炎确诊病例（两人行动轨迹相同)，病例分型分别为轻型和普通型。两人为广东省广州市人。21日，其中一名确诊病例伍先生告诉极目新闻记者，10月9日至11日，他曾在内蒙古额济纳旗游玩，与此前被确诊的8人旅行团存在轨迹重叠。伍先生称，他从13日开始咳嗽，但自己以为是老毛病又犯了，压根没想到是被感染了，直到返程途中经过湖北主动去做核酸检测才被发现。


            </article>
        </main>
    </div><!--/.wrap-->


    <!--================================================================================-->
    <!--                            JAVASCRIPT                                          -->
    <!--================================================================================-->
    <script type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript" src="assets/libs/jquery.html2canvas.min.js"></script><!--网页转成图片控件-->
    <script type="text/javascript" src="assets/neatui/js/neatui.min.js"></script><!--前端框架-->
    <script type="text/javascript" src="assets/neatui/js/neatui-functions.js"></script><!--函数库-->
    <script type="text/javascript">
        //——————————————————————————————————————————
        var scrollDistance = 0;
    
        //——————————————————————————————————————————
        $(window).on('scroll', function(){
            var scrollTop = $(window).scrollTop();
            if(scrollTop > 0){
                scrollDistance = scrollTop;
            }
        });


        //——————————————————————————————————————————
        /**
         * [调用示例]
            neui.exportWeb2Image(options);
                options参数：
                var options = {
                    element: "body", // 要转换成图片的选择器节点(可选), 默认'body'。若是整个网页，传值：'body', 若是部分区域，则传值：'#节点ID。 eg1. 'body', eg2.'#users', eg3.'.user'
                    filename: "下载图片.png", // 下载后的图片名称(仅pc端时有效)(可选)。
                    caption: "长按图片“保存到手机”" // 弹出窗口的标题(仅移动端时有效)(可选)。
                    closeCallBack: null // 窗口关闭时的回调函数(可选)。
                }
        */


        //——————————————————————————————————————————
        //=====示例1：保存黄色区域为图片
        var btnYellow = document.getElementById('btn-save-area');
        btnYellow.addEventListener('click', function(){
            neui.exportWeb2Image({
                element: '#colored',
                filename: 'Hello World.jpg',
                caption: '长按保存图片'
            });
        });



        //——————————————————————————————————————————
        //=====示例2：保存整个网页为图片
        var btnAll = document.getElementById('btn-save-web');
        btnAll.addEventListener('click', function(){
            utilities.elementScrollTo({
                element: window,
                top: 0, // 先滚到顶部
                left: 0,
                behavior: 'instant',
                callback: function(){ // 回调

                    // 导出图片
                    neui.exportWeb2Image({
                        element: '.wrap',
                        filename: '用户资料.png',
                        caption: '长按保存图片',
                        closeCallBack: function(){
                            // 再滚回原位置
                            window.scrollTo({
                                top: scrollDistance,
                                left: 0,
                                behavior: "smooth"
                            })
                        }
                    })
                    
                }
            })
        });




    </script>
</body>
</html>