

 //————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
 //                                                   JS插件开发的几种方式
 //                                  注：           //... 表示省一堆代码
 //————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————————
/**
*  参考文档：
    JavaScript中new一个函数和直接调用函数的区别：https://www.cnblogs.com/vicky-li/p/8669549.html
    JavaScript中call()、apply()、bind() 的用法：https://www.runoob.com/w3cnote/js-call-apply-bind.html
    JS封装——构建自己的jQuery插件： https://www.jianshu.com/p/7e6c25563685
    原生js插件的封装写法： https://www.cnblogs.com/wgb1234/articles/16640397.html
*
*/

//::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
//                    jQuery extend 封装控件1
//::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
// jQuery 插件开发
;(function ($) {

    var defaults = {
        // 这里是控件默认参数
    };

    var settings = {};

    // 定义methods对象
    var methods = {
        init: function(options){
            var _this = this; // 控件元素对象
            var defaults = {
                // 这里是控件默认参数
            }
            settings = $.extend(true, {}, defaults, options || {});
   
            //...

            return this.each(function(){
                var $this = $(this); // 控件元素对象
            })
        },
        event1: function(source, options){ // 函数1
            //...
        },
        event2: function(userName, userSex, userAge){ // 函数2
            //...
        }
    };

    // 内部对象，对象中的函数仅供内部使用，故用下划线_开头表示私有函数
    var helpers = {
        _aaa: function(){

        },
        _bbb: function(){

        },
        _ccc: function(){

        }
    };

    //...

    //对外暴露接口
    $.fn.jeDate = function(method){
        if(methods[method]){
            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
        }else if(typeof method === 'object' || !method){
            return methods.init.apply(this, arguments);
        }else{
            $.error('Method ' + method + ' does not exist in jQuery');
        }
    }

})(jQuery);


//=====前台调用示例
//eg1.
$('#id').jeDate('init', opts); // 调用控件内部init函数,并传递参数opts
//eg2.
$('#id').jeDate('event1', source, opts); // 调用控件内部event1函数，并传递对应的两个参数source, opts
//eg3.
$('#id').jeDate('event2', userName, userSex, userAge); // 调用控件内部event2函数，并传递对应的三个参数：userName, userSex, userAge





//::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
//                    jQuery extend 封装控件2
//::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
// jQuery 插件开发
;(function ($) {

    //...

    $.fn.NeDate = function(options){
        return new MyJet(this, options); // 实例化 MyJet 函数
    };

    // 定义一个函数(其实该函数也是一个对象) MyJet
    var MyJet = function(element, options){
        var me = this;
        me.$element = element;
        //后面可设置一堆内部变量
        me.aa = '';
        me.bb = '';

        //...

        me.init(options);
    };

    // 给 MyJet 添加函数或对象
    MyJet.prototype.init = function(options){
        var me = this;
        var defaults = {

        }
        var settings = $.extend(true, {}, defaults, options || {});
        me.opts = settings;
        //...
    };

    MyJet.prototype.event1 = function(){ // 函数1
        //..
    };
    MyJet.prototype.event2 = function(){ // 函数2
        //..
    };

    //...

})(jQuery);



//=====前台调用示例
$('#id').NeDate(opts); // opts是一个对象








//::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
//                    原生JS封装控件
//::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::

//————————————————————————————————————————————————————————————————————————————————————
//            只调用单一方法
//————————————————————————————————————————————————————————————————————————————————————
;(function(root, factory){
    if (typeof define === 'function' && define.amd) { // amd
        define(factory);
    } else if (typeof exports === 'object') { // umd
        module.exports = factory();
    } else {
        window.NeDate = factory();
    }
})(this, function(){
    var NeDate = function(elem,options){
        var opts = typeof (options) === "function" ? options() : options;
        return new DatePick(elem, opts);
    };
    //...
    function DatePick(elem, options){
        var defaults = {
            
        }
    }
    //...  
    return NeDate; // 返回对象
});

//=====前台调用示例
NeDate(elem, options);




//————————————————————————————————————————————————————————————————————————————————————
//                  可调用多个方法
//————————————————————————————————————————————————————————————————————————————————————
;(function(root, factory){
    if (typeof define === 'function' && define.amd) { // amd
        define(factory);
    } else if (typeof exports === 'object') { // umd
        module.exports = factory();
    } else {
        window.NeDate = factory();
    }
})(this, function(){
    var NeDate = function(){
        var me = this;
        this.init = function(elem, opts){
            console.log('init方法：elem1：', elem, '\noptions1：', opts);
        };
        this.load = function(elem, opts){
            console.log('house方法：elem2：', elem, '\noptions2：', opts);
        };
    }
    //... 
    return NeDate; // 返回对象
});

//=====前台调用示例
var date = new NeDate(); // 实例化一个对象
date.init('.house', {user:"林冲", sex: "男", grade: "梁山泊"}); 
date.load('.tax',  {source: "数据源"});




//————————————————————————————————————————————————————————————————————————————————————
//                  可调用多个方法2
// 控件对象既可当函数使用，又可当对象使用。
//————————————————————————————————————————————————————————————————————————————————————
;(function(root, factory){
    if (typeof define === 'function' && define.amd) { // amd
        define(factory);
    } else if (typeof exports === 'object') { // umd
        module.exports = factory();
    } else {
        window.NeDate = factory();
    }
})(this, function(){

    //================================================================
    // 构造函数
    //================================================================
    function NeDate(elem, options){
        this.defaults = {
            method: "GET",
            data: {

            }
        }
    };



    //================================================================
    // 原型添加相关的方法
    //================================================================
    NeDate.prototype.init = function(elem, options){
        this.settings = utils.extend(true, {}, this.defaults, options || {});
    };
    NeDate.prototype.load = function(elem, options){
        this.settings = utils.extend(true, {}, this.defaults, options || {});
    };



    //================================================================
    // 工具库
    //================================================================
    var utils = {
    
        /**
        * 原生JS合并对象
        */
        extend: function(){
            
        }  
    };


    //================================================================
    // 返回对象
    //================================================================
    return NeDate;
});

//================================================================
//  创建“既是函数又是对象”的实例
//================================================================
function createNewInstace(dom, config){
    // 说明：bind()就是将函数绑定到某个对象上。 例如：f.bind(obj)，实际上可以理解为 obj.f()
    // 实例化一个对像
    var context = new NeDate(dom, config); // context 是一个实例化的对象，只能当对象使用，不能当函数使用。
    // 创建请求函数
    var instance = NeDate.prototype.init.bind(context); // instance 是一个函数，由 bind 返回的一个新函数，可以调用 instance()。
    // 将 Axios.prototype 对象中的方法添加到 instance 函数对象中
    // 为了实现能够将 instance 函数作为对象使用，我们就要将 NeDate.prototype 对象中的方法添加给 instance 。毕竟函数也一个对象，也能够添加方法。
    Object.keys(NeDate.prototype).forEach(function(item){
        instance[item] = NeDate.prototype[item].bind(context);
    });
    // 为 instance 函数对象添加属性
    Object.keys(context).forEach(function(item){
        instance[item] = context[item];
    })
    return instance;
}
var neDate = createNewInstace();




//=====前台调用示例
// 控件对象当作函数用
neDate("#app", {
    method: "GET",
    data: {
        name: "小明",
        grade: "三年级",
        sex: "男",
        age: 10
    }
});

// 控件对象当作对象用 ^_^
neDate.load("#app", {
    method: "POST",
    data: {
        name: "小王",
        grade: "五年级",
        sex: "女",
        age: 12
    }
});
